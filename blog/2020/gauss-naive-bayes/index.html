<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Idea and Implementation / Bayes Theorem and Gaussian Naive Bayes | Md Abdur Razzaq Riyadh </title> <meta name="author" content="Md Abdur Razzaq Riyadh"> <meta name="description" content="visual explanation of Naive Bayes, inspired by 3Blue1Brown."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://riyadhrazzaq.github.io/blog/2020/gauss-naive-bayes/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Riyadh </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/resume-md-abdur-razzaq.pdf">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Idea and Implementation / Bayes Theorem and Gaussian Naive Bayes</h1> <p class="post-meta"> Created in July 03, 2020 </p> <p class="post-tags"> <a href="/blog/2020"> <i class="fa-solid fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/algorithm"> <i class="fa-solid fa-hashtag fa-sm"></i> algorithm</a>   <a href="/blog/tag/theory"> <i class="fa-solid fa-hashtag fa-sm"></i> theory</a>   ·   <a href="/blog/category/machine-learning"> <i class="fa-solid fa-tag fa-sm"></i> machine-learning</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="bayes-theroem">Bayes Theroem</h1> <p>Any naive bayes approach including Gaussian Naive Bayes depends on the Bayes Theorem. Bayes theorem gives us the probability of an event, given that we have some extra knowledge about that event.</p> \[P(A \mid B) = \frac{P(A) \ P(B \mid A)}{P(B)}\] <p>This is the mathmatical definition of the theorem. Here, \(A\) and \(B\) are events and \(P(B) \ne 0\)</p> <ul> <li>\(P(A \mid B)\) a conditional probability. It is read as the likelyhood of event A occuring given that event B is true. In an experiment this is our objective variable.</li> <li>\(P(A)\) is prior probability. We are supposed to observe the value of this in our experiment.</li> <li>\(P(B \mid A)\) is the conditional probability of B happening given A true.</li> </ul> <p>There is a rather intuitive explanation behind this legendary theroy.</p> <h2 id="smoke-and-fire-experiment">Smoke and Fire Experiment</h2> <p>Our hypothesis is that there will be fire if there is smoke. So, we are asking for \(P(Fire \mid Smoke)\). To answer that we’ll start with an experiment sample.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/images/2020-07-03-gauss-naive-bayes/NB1-480.webp 480w,/assets/images/2020-07-03-gauss-naive-bayes/NB1-800.webp 800w,/assets/images/2020-07-03-gauss-naive-bayes/NB1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/images/2020-07-03-gauss-naive-bayes/NB1.png" class="img-fluid z-depth-1" width="100%" height="auto" style=" max-width: 800; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>When we collect data about <em>Fire</em> and <em>No Fire</em> events, the area of the white square represents the total sample space.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/images/2020-07-03-gauss-naive-bayes/NB2-480.webp 480w,/assets/images/2020-07-03-gauss-naive-bayes/NB2-800.webp 800w,/assets/images/2020-07-03-gauss-naive-bayes/NB2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/images/2020-07-03-gauss-naive-bayes/NB2.png" class="img-fluid z-depth-1" width="100%" height="auto" style=" max-width: 800; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>And we see that we area on the left is <em>Fire</em> and on the right is <em>No Fire</em> samples.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/images/2020-07-03-gauss-naive-bayes/NB3-480.webp 480w,/assets/images/2020-07-03-gauss-naive-bayes/NB3-800.webp 800w,/assets/images/2020-07-03-gauss-naive-bayes/NB3-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/images/2020-07-03-gauss-naive-bayes/NB3.png" class="img-fluid z-depth-1" width="100%" height="auto" style=" max-width: 800; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Now let’s observe in which samples smoke was seen in a fire, and in which sample smoke was seen even though there were no fire. Note that, smoke seen in a fire can be written as \((Smoke \mid Fire)\) and not seen in a fire can be written as \((Smoke \mid No Fire)\). Red areas represents smoke was seen. These red areas that I have drawn is based on gut feeling. Smoke is common when there’s a fire, so red area is bigger compared to the red area when there is no fire. Now, as we know probability of something happening is effectively the ratio of that thing against all other thing. Hence, \(P(Smoke \mid Fire)\) is equals to red area inside fire divided by total red are in experiment.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/images/2020-07-03-gauss-naive-bayes/NB5-480.webp 480w,/assets/images/2020-07-03-gauss-naive-bayes/NB5-800.webp 800w,/assets/images/2020-07-03-gauss-naive-bayes/NB5-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/images/2020-07-03-gauss-naive-bayes/NB5.png" class="img-fluid z-depth-1" width="100%" height="auto" style=" max-width: 800; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>But how the red areas can be calculated mathematically? Well, area is the product of height and width. In our experiment, height is the \(P(Smoke \mid Fire)\) and width is \(P(Fire)\). Similarly the red area in <em>No Fire</em> can be calculated.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/images/2020-07-03-gauss-naive-bayes/NB6-480.webp 480w,/assets/images/2020-07-03-gauss-naive-bayes/NB6-800.webp 800w,/assets/images/2020-07-03-gauss-naive-bayes/NB6-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/images/2020-07-03-gauss-naive-bayes/NB6.png" class="img-fluid z-depth-1" width="100%" height="auto" style=" max-width: 800; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>So, we finally get this equation on top.</p> <p>Note: This is just a geometrical explanation of Bayes Theorem. Gaussian Naive Bayes and other naive bayes algorithms differentiate themselves from this by how they calculate \(P(Smoke \mid Fire)\).</p> <h1 id="gaussian-naive-bayes">Gaussian Naive Bayes</h1> <p>This algorithm assumes likelyhoods of features are of gaussian distribution.</p> \[P(x_i \mid y) = \frac{1}{\sqrt{2\pi\sigma^2_y}} \exp\left(-\frac{(x_i - \mu_y)^2}{2\sigma^2_y}\right)\] <h1 id="implementation">Implementation</h1> <p>We need to calculate priors,\(P(A)\), mean \(\mu_y\) and standard deviation, \(\sigma_y\) of all features for each available classes in y. Then a function to crunch the above formula of \(P(x_i \mid y)\)</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">math</span>

<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span> <span class="c1"># linear algebra
</span><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span> <span class="c1"># data processing, CSV file I/O (e.g. pd.read_csv)
</span>
<span class="kn">from</span> <span class="n">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="n">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">GaussNB</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        No params are needed for basic functionality.
        </span><span class="sh">"""</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">_mean</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">X</span><span class="p">):</span> <span class="c1"># CHECKED
</span>        <span class="sh">"""</span><span class="s">
        Returns class probability for each 
        </span><span class="sh">"""</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">classes_</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argwhere</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">i</span><span class="p">).</span><span class="nf">flatten</span><span class="p">()</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">n_feats</span><span class="p">):</span>
                <span class="n">mean</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span> <span class="n">X</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="p">))</span>
            <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean</span>
        <span class="k">return</span> <span class="n">mu</span>
    
    <span class="k">def</span> <span class="nf">_stddev</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">X</span><span class="p">):</span> <span class="c1"># CHECKED
</span>        <span class="n">sigma</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">classes_</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argwhere</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">y</span><span class="o">==</span><span class="n">i</span><span class="p">).</span><span class="nf">flatten</span><span class="p">()</span>
            <span class="n">stddev</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">n_feats</span><span class="p">):</span>
                <span class="n">stddev</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span> <span class="n">np</span><span class="p">.</span><span class="nf">std</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stddev</span>
        <span class="k">return</span> <span class="n">sigma</span>
    
    <span class="k">def</span> <span class="nf">_prior</span><span class="p">(</span><span class="n">self</span><span class="p">):</span> <span class="c1"># CHECKED
</span>        <span class="sh">"""</span><span class="s">Prior probability, P(y) for each y
        </span><span class="sh">"""</span>
        <span class="n">P</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">classes_</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argwhere</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">y</span><span class="o">==</span><span class="n">i</span><span class="p">).</span><span class="nf">flatten</span><span class="p">().</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">probability</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">self</span><span class="p">.</span><span class="n">y</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">probability</span>
        <span class="k">return</span> <span class="n">P</span>
    
    <span class="k">def</span> <span class="nf">_normal</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mean</span><span class="p">,</span><span class="n">stddev</span><span class="p">):</span> <span class="c1"># CHECKED
</span>        <span class="sh">"""</span><span class="s">
        Gaussian Normal Distribution
        $P(x_i \mid y) = </span><span class="se">\f</span><span class="s">rac{1}{\sqrt{2\pi\sigma^2_y}} \exp\left(-</span><span class="se">\f</span><span class="s">rac{(x_i - \mu_y)^2}{2\sigma^2_y}</span><span class="se">\r</span><span class="s">ight)$
        </span><span class="sh">"""</span>
        
        <span class="n">multiplier</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span> <span class="nf">float</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">stddev</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span> 
        <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="nf">float</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">stddev</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="n">exp</span>

    
    <span class="k">def</span> <span class="nf">P_E_H</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Uses Normal Distribution to get, P(E|H) = P(E1|H) * P(E2|H) .. * P(En|H)
        
        params
        ------
        X: 1dim array. 
            E in P(E|H)
        H: class in y
        </span><span class="sh">"""</span>
        <span class="n">pdfs</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">n_feats</span><span class="p">):</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">means_</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">stddevs_</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">pdfs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span> <span class="n">self</span><span class="p">.</span><span class="nf">_normal</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span> <span class="p">)</span>
            
        <span class="n">p_e_h</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">prod</span><span class="p">(</span><span class="n">pdfs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p_e_h</span>
        
        
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">n_feats</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">self</span><span class="p">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">y</span><span class="p">).</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">means_</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_mean</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="c1"># dict of list {class:feats}
</span>        <span class="n">self</span><span class="p">.</span><span class="n">stddevs_</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_stddev</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="c1"># dict of list {class:feat}
</span>        <span class="n">self</span><span class="p">.</span><span class="n">priors_</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_prior</span><span class="p">()</span> <span class="c1"># dict of priors 
</span>        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">X</span><span class="p">):</span>
        <span class="n">samples</span><span class="p">,</span> <span class="n">feats</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="n">samples</span><span class="o">!=</span><span class="n">self</span><span class="p">.</span><span class="n">n_samples</span> <span class="ow">or</span> <span class="n">feats</span><span class="o">!=</span><span class="n">self</span><span class="p">.</span><span class="n">n_feats</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">DimensionError</span><span class="p">(</span><span class="sh">"</span><span class="s">No dimension match with training data!</span><span class="sh">"</span><span class="p">)</span>
            
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
            <span class="n">distinct_likelyhoods</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">classes_</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nc">P_E_H</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">h</span><span class="p">)</span>
                <span class="n">distinct_likelyhoods</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span> <span class="n">tmp</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">priors_</span><span class="p">[</span><span class="n">h</span><span class="p">])</span>
            <span class="n">marginal</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">distinct_likelyhoods</span><span class="p">)</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">probas</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">classes_</span><span class="p">:</span>
                <span class="n">numerator</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">priors_</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">*</span> <span class="n">distinct_likelyhoods</span><span class="p">[</span><span class="n">tmp</span><span class="p">]</span>
                <span class="n">denominator</span> <span class="o">=</span> <span class="n">marginal</span>
                <span class="n">probas</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span> <span class="p">)</span>
                <span class="n">tmp</span><span class="o">+=</span><span class="mi">1</span>
            <span class="c1"># predicting maximum
</span>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">probas</span><span class="p">)</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">classes_</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gnb</span> <span class="o">=</span> <span class="nc">GaussianNB</span><span class="p">()</span>
<span class="n">sk_pred</span> <span class="o">=</span> <span class="n">gnb</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">).</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Sci-kit Learn: </span><span class="sh">"</span><span class="p">,</span><span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">sk_pred</span><span class="p">))</span>

<span class="n">nb</span> <span class="o">=</span> <span class="nc">GaussNB</span><span class="p">()</span>
<span class="n">nb</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">me_pred</span> <span class="o">=</span> <span class="n">nb</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Custom GaussNB: </span><span class="sh">"</span><span class="p">,</span><span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">me_pred</span><span class="p">))</span>
</code></pre></div></div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/nov24-papers/">Multimodal LLMs on top of LLaMA 3</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/contrastive-predictive-coding/">Paper Notes / Contrastive Predicting Coding</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/lct/">আমার ইরাস্মুসে আবেদন</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/counting/">Permutation and Combination</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/email-using-python/">Creating emails using EmailMessage in Python 3.8</a> </li> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 Md Abdur Razzaq Riyadh. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: December 06, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-cv",title:"cv",description:"CV",section:"Navigation",handler:()=>{window.location.href="/assets/pdf/resume-md-abdur-razzaq.pdf"}},{id:"dropdown-publications",title:"publications",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-projects",title:"projects",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-blog",title:"blog",description:"",section:"Dropdown",handler:()=>{window.location.href="/blog/"}},{id:"post-multimodal-llms-on-top-of-llama-3",title:"Multimodal LLMs on top of LLaMA 3",description:"notes on paper read in Nov, 24.",section:"Posts",handler:()=>{window.location.href="/blog/2024/nov24-papers/"}},{id:"post-paper-notes-contrastive-predicting-coding",title:"Paper Notes / Contrastive Predicting Coding",description:"my notes on the paper 'Representation Learning with Contrastive Predictive Coding' by Oord et al.",section:"Posts",handler:()=>{window.location.href="/blog/2024/contrastive-predictive-coding/"}},{id:"post-\u0986\u09ae\u09be\u09b0-\u0987\u09b0\u09be\u09b8\u09cd\u09ae\u09c1\u09b8\u09c7-\u0986\u09ac\u09c7\u09a6\u09a8",title:"\u0986\u09ae\u09be\u09b0 \u0987\u09b0\u09be\u09b8\u09cd\u09ae\u09c1\u09b8\u09c7 \u0986\u09ac\u09c7\u09a6\u09a8",description:"how I applied for the Erasmus Mundus scholarship.",section:"Posts",handler:()=>{window.location.href="/blog/2024/lct/"}},{id:"post-permutation-and-combination",title:"Permutation and Combination",description:"explaining permutation and combination with examples.",section:"Posts",handler:()=>{window.location.href="/blog/2024/counting/"}},{id:"post-creating-emails-using-emailmessage-in-python-3-8",title:"Creating emails using EmailMessage in Python 3.8",description:"explaining permutation and combination with examples",section:"Posts",handler:()=>{window.location.href="/blog/2020/email-using-python/"}},{id:"post-\u09ad\u09c7\u0995\u09cd\u099f\u09b0",title:"\u09ad\u09c7\u0995\u09cd\u099f\u09b0",description:"explaining permutation and combination with examples.",section:"Posts",handler:()=>{window.location.href="/blog/2020/intro-to-vectors/"}},{id:"post-idea-and-implementation-boosting",title:"Idea and Implementation / Boosting",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/boosting/"}},{id:"post-idea-and-implementation-random-forest",title:"Idea and Implementation / Random Forest",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/random-forest/"}},{id:"post-idea-and-implementation-bagging",title:"Idea and Implementation / Bagging",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/bagging/"}},{id:"post-idea-and-implementation-multinomial-naive-bayes",title:"Idea and Implementation / Multinomial Naive Bayes",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/multi-naive-bayes/"}},{id:"post-idea-and-implementation-bayes-theorem-and-gaussian-naive-bayes",title:"Idea and Implementation / Bayes Theorem and Gaussian Naive Bayes",description:"visual explanation of Naive Bayes, inspired by 3Blue1Brown.",section:"Posts",handler:()=>{window.location.href="/blog/2020/gauss-naive-bayes/"}},{id:"post-house-prices-prediction-with-decision-tree",title:"House Prices Prediction with Decision Tree",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/house-price-advance/"}},{id:"post-metrics-for-classification-from-scratch",title:"Metrics for Classification from Scratch",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/classification-metrics/"}},{id:"post-paper-review-keyphrase-extraction-drnn-twitter",title:"Paper Review [Keyphrase Extraction, DRNN, Twitter]",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/PaperReview-03/"}},{id:"post-paper-review-keyword-extraction-svm",title:"Paper Review [Keyword Extraction, SVM]",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/PaperReview-02/"}},{id:"post-paper-review-sentiment-analysis-lstm",title:"Paper Review [Sentiment Analysis, LSTM]",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/PaperReview-01/"}},{id:"post-islr-chapter-04-classification",title:"[ISLR] Chapter 04 - Classification",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2019/ch04/"}},{id:"post-common-terms-in-statistics-ii",title:"Common terms in Statistics II",description:"Degrees of Freedom, F-statistic, P-value, R^2 statistic",section:"Posts",handler:()=>{window.location.href="/blog/2019/common-terms-2/"}},{id:"post-common-terms-in-statistics-i",title:"Common terms in Statistics I",description:"Quartile, Standard Deviation",section:"Posts",handler:()=>{window.location.href="/blog/2019/common-terms/"}},{id:"post-unbounded-knapsack-minimization-for-spoj-pigbank",title:"Unbounded Knapsack (Minimization) for SPOJ-PIGBANK",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2018/unbounded-knapsack/"}},{id:"post-spoj-anarc09a-seinfeld",title:"[SPOJ] ANARC09A - Seinfeld",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2018/spoj-anarc09a/"}},{id:"post-balancing-brackets",title:"Balancing Brackets",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2018/balancing-brackets/"}},{id:"post-spoj-enigmath-solution",title:"SPOJ ENIGMATH Solution",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2018/spoj-enigmath/"}},{id:"post-next-smallest-palindrome",title:"Next Smallest Palindrome",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2018/next-smallest-palindrome/"}},{id:"post-bitwise-sieve-w-code",title:"Bitwise Sieve w/ Code",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2018/bitwise-sieve/"}},{id:"post-spoj-3410-samer08f-feynman",title:"SPOJ 3410: SAMER08F - Feynman",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2018/SPOJ-3410/"}},{id:"post-spoj-1112-nsteps",title:"SPOJ 1112: NSTEPS",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2018/SPOJ-1112/"}},{id:"news-i-have-joined-cmed-health-as-a-junior-software-engineer",title:"I have joined CMED Health as a Junior Software Engineer.",description:"",section:"News"},{id:"news-i-have-been-promoted-to-software-engineer-at-cmed-health-https-cmed-com-bd-smiley-tada-rocket",title:'I have been promoted to Software Engineer at [CMED Health](https://cmed.com.bd/) <img class="emoji" title=":smiley:" alt=":smiley:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f603.png" height="20" width="20"> <img class="emoji" title=":tada:" alt=":tada:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f389.png" height="20" width="20"> <img class="emoji" title=":rocket:" alt=":rocket:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f680.png" height="20" width="20">...',description:"",section:"News"},{id:"news-i-have-joined-bracit-https-cmed-com-bd-as-a-software-engineer",title:"I have joined [BracIT](https://cmed.com.bd/) as a Software Engineer.",description:"",section:"News"},{id:"news-i-have-received-an-erasmus-mundus-scholarship-to-study-in-the-masters-in-lct-https-lct-master-org-programme-books-smiley",title:"I have received an Erasmus Mundus scholarship to study in the masters in...",description:"",section:"News"},{id:"news-i-have-participated-in-two-workshops-at-acl-2024-iwslt-2024-and-arabicnlp-2024-checkout-the-publication-publications-page-for-details",title:"I have participated in two workshops at ACL 2024: **IWSLT 2024** and **ArabicNLP...",description:"",section:"News"},{id:"news-i-have-started-a-research-internship-at-ixa-https-ixa-eus-under-the-supervision-of-professor-eneko-agirre-https-eagirre-github-io",title:"I have started a research internship at [Ixa](https://ixa.eus) under the supervision of [Professor...",description:"",section:"News"},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-project-2",title:"project 2",description:"a project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%72%69%79%61%64%68.%72%61%7A%7A%61%71@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=4paJ0vwAAAAJ","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/riyadhrazzaq","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/riyadhrazzaq","_blank")}},{id:"socials-flickr",title:"Flickr",section:"Socials",handler:()=>{window.open("https://www.flickr.com/riyadhrazzaq","_blank")}},{id:"socials-kaggle",title:"Kaggle",section:"Socials",handler:()=>{window.open("https://www.kaggle.com/riyadhrazzaq","_blank")}},{id:"socials-bluesky",title:"Bluesky",section:"Socials",handler:()=>{window.open("https://bsky.app/profile/riyadhrazzaq.bsky.social","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>